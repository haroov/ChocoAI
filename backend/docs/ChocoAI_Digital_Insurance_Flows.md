# ChocoAI – Digital Insurance Flows (MVP)

מטרת המסמך: להגדיר שהשיח מתנהל כסוכן/ת ביטוח (שוקו) מול לקוח/ה שרוצה לרכוש ביטוח – בצורה תהליכית וברורה.

## עקרונות שיחה

- **הקשר**: שוקו הוא סוכן ביטוח שמוביל תהליך רכישה.
- **שפה**: אם הלקוח/ה כותב/ת בעברית – ממשיכים בעברית. אם באנגלית – ממשיכים באנגלית.
- **UX**: שאלה אחת בכל פעם. אם הלקוח/ה נותן/ת כמה פרטים יחד – קולטים הכול ומתקדמים.
- **תוצאה**: איסוף מידע → בניית טופס הצעה (Intake JSON) → יצירת **PDFs** של טפסי ההצעה (SMB / Cyber / Med PI).
- **אישור קיום ביטוחי (COI)**: ניתן לתת *רק* ללקוח/ה **קיים/ת** עם **פוליסה קיימת**. בכל מקרה אחר (לא לקוח/ה / אין פוליסה) – מפנים לתהליך **הזדהות/הרשמה** ולהמשך **רכישה/מכירה** (אין להנפיק/להתחייב על אישור קיום).

---

## Flow 0: אישור קיום ביטוחי (Policy Existence Confirmation / COI)

### מטרה
להנפיק אישור קיום ביטוחי (COI) *רק* אחרי זיהוי + אימות לקוח/ה קיים/ת + אימות פוליסה קיימת.

### תנאי סף (חובה)
- אם הלקוח/ה **לא לקוח/ה רשום/ה** → מבצעים **הרשמה** ואז ממשיכים לתהליך **מכירת פוליסה** (אין COI).
- אם הלקוח/ה **לקוח/ה רשום/ה אבל אין פוליסה קיימת** → ממשיכים לתהליך **מכירת פוליסה** (אין COI).
- אם הלקוח/ה **לקוח/ה רשום/ה עם פוליסה קיימת** → שולחים **OTP לנייד** וממשיכים להפקת COI.

### מה אוספים (MVP)
- **זיהוי והזדהות**: נייד/אימייל + OTP
- **פרטי זיהוי בסיסיים** (אם חסרים): שם פרטי, שם משפחה, נייד, אימייל, כתובת
- **פרטי האישור** (במינימום): למי מיועד האישור, שם המבוטח/ה, תאריך נדרש, הערות מיוחדות

---

## Flow 1: זיהוי הלקוח/ה (Identify Customer)

### מטרה
לקשר את השיחה לישות המבוטחת (בית העסק) ולאיש/אשת הקשר.

### מה אוספים (MVP)
- **איש/אשת קשר**: שם פרטי + שם משפחה
- **פרטי קשר**: נייד, אימייל
- **כתובת**: עיר, רחוב, מספר (ושאר פרטי כתובת אם קיימים)
- *(לפי הצורך בתהליך מכירה)* **שם בית העסק** + **מזהה משפטי**: ח״פ / ע״מ / ת״ז (וגם סוג מזהה)

### דוגמת ניסוח
״בשמחה — כדי להתחיל, מה השם הפרטי והשם משפחה שלך ומה מספר הנייד?״

---

## Flow 2: בירור צרכים (Needs Discovery)

### מטרה
להבין איזה ביטוח צריך ומה הסיכונים/כיסויים הדרושים כדי לבחור מסלול וטפסים.

### מה אוספים (MVP)
- **קו מוצר**: `business_package` / `cyber` / `med_pi`
- **כיסויים** (בטקסט חופשי במינימום, לפי התחום): מבנה, תכולה, מלאי, צד ג׳, חבות מעבידים, אחריות מקצועית, אחריות מוצר, סייבר/דלף מידע
- **התמחות**: ביטוח לעסקים קטנים/בינוניים (SMB). התמחות ספציפית: **מטפלים ומקצועות פרא־רפואיים** (PI / אחריות מקצועית).
- **סיכונים מיוחדים**: חשיפה למידע רגיש, עבודה מול קהל, שימוש בציוד יקר, פעילות מחוץ לקליניקה, עבודה עם ילדים/אוכלוסיות מיוחדות וכו׳ (כדי לכוון שאלות איסוף מידע).

### תוצר
פתיחת/קישור **InsuranceCase** לשיחה (תיק ביטוח) כדי שכל המידע והמסמכים יתועדו על אותו תיק.

---

## Flow 3: מילוי טופס הצעה + יצירת PDFs (Proposal Form)

### מטרה
להשלים פרטי הצעה בסיסיים ולייצר טפסי PDF להגשה לחברת הביטוח.

### מה אוספים (MVP)
- פעילות עיקרית בעסק
- כתובת (עיר/רחוב/מספר)
- מספר עובדים
- סכומי ביטוח בסיסיים (תכולה/מלאי אם רלוונטי)
- גבול אחריות צד ג׳

### תוצרים
- יצירת **InsuranceIntake** גרסה־אחר־גרסה (Versioned payload).
- יצירת **PdfDocument**(ים) לפי התבניות הפעילות (למשל: `clal_smb_15943`, `clal_cyber`, `clal_med_pi`).

---

## MVP Flows in Code (ברירת מחדל)

- Router: `welcome`
- Needs Discovery: `needsDiscovery`
- Proposal: `proposalForm`

הזרימה המצופה:
`welcome` → `needsDiscovery` → `proposalForm` → יצירת PDFs

